<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ALAAP - Rider Operations</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   
    <style>
        :root {
            --primary-blue: #2563EB;
            --secondary-blue: #1D4ED8;
            --light-blue: #EFF6FF;
            --text-dark: #1F2937;
            --text-muted: #6B7280;
            --bg-gray: #F3F4F6;
            --white: #FFFFFF;
            --border-color: #E5E7EB;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --input-bg: #FAFAFA;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
            background-color: var(--bg-gray);
        }

        /* Mobile Container Simulation */
        .app-container {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            background-color: var(--bg-gray);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            margin: 0 auto;
        }

        @media (min-width: 415px) {
            body {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                padding: 20px;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            .app-container {
                width: 375px;
                height: 812px;
                border-radius: 40px;
                box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            }
        }

        /* Header Section - Dynamic based on status */
        .rider-header {
            background: linear-gradient(135deg, var(--secondary-blue), var(--primary-blue));
            padding: 50px 20px 30px;
            color: var(--white);
            position: relative;
            transition: all 0.5s ease;
        }

        .rider-header.offline-mode {
            background: linear-gradient(135deg, #4B5563, #6B7280);
        }

        .rider-header.busy-mode {
            background: linear-gradient(135deg, #D97706, #F59E0B);
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .greeting h2 {
            font-size: 24px;
            font-weight: 600;
        }

        .greeting p {
            font-size: 13px;
            opacity: 0.9;
        }

        .profile-pic {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.5);
            background: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-size: 20px;
        }

        /* Status Toggle Card */
        .status-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .status-info h3 {
            font-size: 14px;
            font-weight: 400;
            opacity: 0.9;
            margin-bottom: 4px;
        }

        .status-info .status-text {
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--success);
            box-shadow: 0 0 10px var(--success);
            animation: pulse 2s infinite;
        }

        .status-indicator.offline {
            background-color: var(--text-muted);
            box-shadow: none;
            animation: none;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            width: 60px;
            height: 32px;
        }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0,0,0,0.3);
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--success); }
        input:checked + .slider:before { transform: translateX(28px); }

        /* Main Content Area */
        .content-section {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            position: relative;
        }

        .content-section::-webkit-scrollbar { display: none; }

        /* Queue Section */
        .section-title {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .queue-card {
            background: var(--white);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .queue-visual {
            width: 120px;
            height: 120px;
            margin: 0 auto 15px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .queue-ring {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid var(--bg-gray);
            border-top-color: var(--primary-blue);
            transform: rotate(-45deg);
            transition: all 0.5s ease;
        }

        .queue-position {
            font-size: 42px;
            font-weight: 700;
            color: var(--primary-blue);
            z-index: 2;
        }

        .queue-label {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .queue-status {
            font-size: 13px;
            color: var(--success);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: var(--white);
            padding: 15px;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-dark);
        }

        /* Booking Assignment Overlay (The Core Feature) */
        .booking-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px);
            z-index: 100;
            display: flex;
            align-items: flex-end;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .booking-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .booking-sheet {
            background: var(--white);
            width: 100%;
            border-radius: 30px 30px 0 0;
            padding: 25px;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 -10px 40px rgba(0,0,0,0.2);
        }

        .booking-overlay.active .booking-sheet {
            transform: translateY(0);
        }

        .sheet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .sheet-title {
            font-size: 18px;
            font-weight: 700;
        }

        .earnings-badge {
            background: var(--light-blue);
            color: var(--primary-blue);
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
        }

        /* Route Visual */
        .route-visual {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding: 15px;
            background: var(--bg-gray);
            border-radius: 16px;
        }

        .location-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-right: 15px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .dot.pickup { background: var(--primary-blue); box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.2); }
        .dot.dropoff { background: var(--success); box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.2); }

        .line {
            position: absolute;
            left: 20px;
            top: 35px;
            bottom: 35px;
            width: 2px;
            background: #CBD5E1;
            z-index: 0;
        }

        .address-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .address-box h4 {
            font-size: 14px;
            color: var(--text-dark);
            margin-bottom: 2px;
        }
        .address-box p {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-decline {
            flex: 1;
            padding: 16px;
            background: var(--bg-gray);
            color: var(--text-dark);
            border: none;
            border-radius: 14px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-decline:active { background: #E5E7EB; transform: scale(0.98); }

        .btn-accept {
            flex: 2;
            padding: 16px;
            background: linear-gradient(135deg, var(--success), #059669);
            color: var(--white);
            border: none;
            border-radius: 14px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .btn-accept:active { transform: scale(0.98); }

        /* Timer Bar */
        .timer-container {
            width: 100%;
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .timer-bar {
            height: 100%;
            background: var(--primary-blue);
            width: 100%;
            transform-origin: left;
            animation: countdown 15s linear forwards;
        }

        @keyframes countdown {
            from { transform: scaleX(1); }
            to { transform: scaleX(0); }
        }

        /* Toast Notification */
        .toast {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: var(--text-dark);
            color: white;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 500;
            z-index: 200;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* Empty State for Offline */
        .offline-state {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 40px;
            opacity: 0.6;
        }
        .offline-icon {
            font-size: 60px;
            color: var(--text-muted);
            margin-bottom: 20px;
        }
        .offline-text {
            font-size: 16px;
            color: var(--text-muted);
            font-weight: 500;
        }

    </style>
<base target="_blank">
</head>
<body>

    <div class="app-container">
       
        <!-- Dynamic Header -->
        <div class="rider-header" id="riderHeader">
            <div class="header-top">
                <div class="greeting">
                    <p>Welcome back,</p>
                    <h2>Rider #882</h2>
                </div>
                <div class="profile-pic">
                    <i class="fa-solid fa-user"></i>
                </div>
            </div>

            <!-- Status Control -->
            <div class="status-card">
                <div class="status-info">
                    <h3>Current Status</h3>
                    <div class="status-text">
                        <span class="status-indicator" id="statusDot"></span>
                        <span id="statusText">Online</span>
                    </div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="statusToggle" checked onchange="toggleStatus()">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content-section" id="mainContent">
            
            <!-- Dashboard View -->
            <div id="dashboardView">
                <h3 class="section-title">Queue Status</h3>
                
                <div class="queue-card">
                    <div class="queue-visual">
                        <div class="queue-ring" id="queueRing"></div>
                        <div class="queue-position" id="queueNumber">3</div>
                    </div>
                    <div class="queue-label">Your Position in Queue</div>
                    <div class="queue-status">
                        <i class="fa-solid fa-wifi"></i> Searching for bookings...
                    </div>
                </div>

                <h3 class="section-title">Today's Summary</h3>
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-label">Completed</div>
                        <div class="stat-value">12</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Earnings</div>
                        <div class="stat-value">₱840</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Online Hrs</div>
                        <div class="stat-value">4.5</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Rating</div>
                        <div class="stat-value">4.9 <i class="fa-solid fa-star" style="font-size:12px; color:var(--warning)"></i></div>
                    </div>
                </div>
            </div>

            <!-- Offline State View -->
            <div class="offline-state" id="offlineView">
                <div class="offline-icon">
                    <i class="fa-solid fa-moon"></i>
                </div>
                <div class="offline-text">You are currently offline.<br>Toggle switch to start receiving orders.</div>
            </div>

        </div>

        <!-- Booking Assignment Overlay -->
        <div class="booking-overlay" id="bookingOverlay">
            <div class="booking-sheet">
                <div class="timer-container">
                    <div class="timer-bar"></div>
                </div>

                <div class="sheet-header">
                    <div class="sheet-title">New Delivery Request</div>
                    <div class="earnings-badge">₱85.00</div>
                </div>

                <div class="route-visual">
                    <div class="location-column">
                        <div class="dot pickup"></div>
                        <div class="dot dropoff"></div>
                    </div>
                    <div class="address-column">
                        <div class="address-box">
                            <h4>Alaminos Public Market</h4>
                            <p>Pick up at Stall #24</p>
                        </div>
                        <div class="address-box">
                            <h4>San Jose Subdivision</h4>
                            <p>Block 5, Lot 12</p>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn-decline" onclick="declineBooking()">Decline</button>
                    <button class="btn-accept" onclick="acceptBooking()">
                        <i class="fa-solid fa-check"></i> Accept
                    </button>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div class="toast" id="toast">
            <i class="fa-solid fa-circle-check"></i>
            <span id="toastMsg">Booking Accepted!</span>
        </div>

    </div>

    <script>
        // State Management
        let isOnline = true;
        let queuePosition = 3;
        let bookingTimer = null;

        // DOM Elements
        const header = document.getElementById('riderHeader');
        const statusDot = document.getElementById('statusDot');
        const statusText = document.getElementById('statusText');
        const dashboardView = document.getElementById('dashboardView');
        const offlineView = document.getElementById('offlineView');
        const bookingOverlay = document.getElementById('bookingOverlay');
        const queueNumber = document.getElementById('queueNumber');
        const queueRing = document.getElementById('queueRing');

        // Toggle Online/Offline Status
        function toggleStatus() {
            isOnline = !isOnline;
            
            if (isOnline) {
                // Switch to Online UI
                header.classList.remove('offline-mode');
                statusDot.classList.remove('offline');
                statusText.innerText = "Online";
                dashboardView.style.display = 'block';
                offlineView.style.display = 'none';
                
                // Restart Simulation
                startQueueSimulation();
                showToast("You are now Online", "success");
            } else {
                // Switch to Offline UI
                header.classList.add('offline-mode');
                statusDot.classList.add('offline');
                statusText.innerText = "Offline";
                dashboardView.style.display = 'none';
                offlineView.style.display = 'flex';
                
                // Stop Simulation
                clearTimeout(bookingTimer);
                bookingOverlay.classList.remove('active');
                showToast("You are now Offline", "neutral");
            }
        }

        // Simulate Queue Movement
        function startQueueSimulation() {
            if (!isOnline) return;

            // Randomly move queue position to simulate activity
            const moveQueue = () => {
                if(!isOnline) return;
                
                // 30% chance to move up in queue
                if (Math.random() > 0.7 && queuePosition > 1) {
                    queuePosition--;
                    updateQueueVisuals();
                }

                // If position 1, high chance to get booking
                if (queuePosition === 1 && Math.random() > 0.5) {
                    triggerBookingAssignment();
                } else {
                    setTimeout(moveQueue, 3000);
                }
            };
            setTimeout(moveQueue, 2000);
        }

        function updateQueueVisuals() {
            queueNumber.innerText = queuePosition;
            // Rotate ring based on position
            const rotation = -45 + (queuePosition * 20);
            queueRing.style.transform = `rotate(${rotation}deg)`;
            
            if(queuePosition === 1) {
                queueNumber.style.color = "var(--success)";
                queueRing.style.borderTopColor = "var(--success)";
            }
        }

        // Trigger Booking Assignment
        function triggerBookingAssignment() {
            if (!isOnline) return;
            bookingOverlay.classList.add('active');
            
            // Auto decline if no response in 15 seconds (simulated by CSS animation)
            // In a real app, we would bind to the animationend event
        }

        // Handle Accept
        function acceptBooking() {
            bookingOverlay.classList.remove('active');
            showToast("Booking Accepted! Navigating...", "success");
            
            // Reset Queue logic for demo
            setTimeout(() => {
                queuePosition = Math.floor(Math.random() * 5) + 2; // Reset to back of queue
                updateQueueVisuals();
                startQueueSimulation();
            }, 2000);
        }

        // Handle Decline
        function declineBooking() {
            bookingOverlay.classList.remove('active');
            showToast("Booking Declined", "error");
            
            // Penalty: move back in queue
            queuePosition += 2;
            updateQueueVisuals();
            startQueueSimulation();
        }

        // Toast Notification System
        function showToast(message, type) {
            const toast = document.getElementById('toast');
            const toastMsg = document.getElementById('toastMsg');
            
            toastMsg.innerText = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Initialize
        updateQueueVisuals();
        startQueueSimulation();

    </script>
</body>
</html>
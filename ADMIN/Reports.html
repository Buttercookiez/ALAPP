<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ALAAP - Reports & Monitoring</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   
    <style>
        /* CSS Variables for Theming */
        :root {
            /* Light Mode (Default) */
            --primary-blue: #2563EB;
            --secondary-blue: #1D4ED8;
            --light-blue: #EFF6FF;
            --text-dark: #1F2937;
            --text-muted: #6B7280;
            --bg-gray: #F3F4F6;
            --white: #FFFFFF;
            --border-color: #E5E7EB;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --purple: #8B5CF6;
            --orange: #F97316;
            
            /* Dynamic Variables */
            --bg-primary: #F3F4F6;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #FFFFFF;
            --text-primary: #1F2937;
            --text-secondary: #6B7280;
            --card-bg: #FFFFFF;
            --card-shadow: 0 2px 8px rgba(0,0,0,0.05);
            --header-bg: linear-gradient(135deg, #1D4ED8, #2563EB);
            --input-bg: #FAFAFA;
            --hover-bg: #F3F4F6;
            --border: #E5E7EB;
            --overlay-bg: rgba(0,0,0,0.5);
        }

        /* Dark Mode */
        [data-theme="dark"] {
            --bg-primary: #0F172A;
            --bg-secondary: #1E293B;
            --bg-tertiary: #334155;
            --text-primary: #F1F5F9;
            --text-secondary: #94A3B8;
            --card-bg: #1E293B;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.3);
            --header-bg: linear-gradient(135deg, #1E3A8A, #1D4ED8);
            --input-bg: #334155;
            --hover-bg: #334155;
            --border: #334155;
            --overlay-bg: rgba(0,0,0,0.7);
            --light-blue: #1E3A8A;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
            background-color: var(--bg-primary);
            transition: background-color 0.3s ease;
        }

        /* Mobile Container Simulation */
        .app-container {
            width: 100%;
            height: 100%;
            max-width: 100%;
            max-height: 100%;
            background-color: var(--bg-primary);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            margin: 0 auto;
            transition: background-color 0.3s ease;
        }

        @media (min-width: 415px) {
            body {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                padding: 20px;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            
            body[data-theme="dark"] {
                background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
            }
            
            .app-container {
                width: 375px;
                height: 812px;
                border-radius: 40px;
                box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            }
        }

        /* Theme Toggle Floating Button */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--card-bg);
            border: none;
            color: var(--text-primary);
            font-size: 20px;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.1) rotate(15deg);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        /* Header Section */
        .reports-header {
            background: var(--header-bg);
            padding: 50px 20px 30px;
            color: white;
            position: relative;
            transition: all 0.3s ease;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .greeting h2 {
            font-size: 24px;
            font-weight: 600;
        }

        .greeting p {
            font-size: 13px;
            opacity: 0.9;
        }

        .back-btn {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: rgba(255,255,255,0.15);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .back-btn:hover { background: rgba(255,255,255,0.25); }
        .back-btn:active { transform: scale(0.95); }

        /* Summary Cards */
        .summary-cards {
            display: flex;
            gap: 12px;
        }

        .summary-card {
            flex: 1;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 16px;
            border: 1px solid rgba(255,255,255,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .summary-card:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .summary-card:active { transform: scale(0.98); }

        .summary-label {
            font-size: 11px;
            opacity: 0.9;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-value {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .summary-change {
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .summary-change.positive { color: #86EFAC; }
        .summary-change.negative { color: #FCA5A5; }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            background: var(--card-bg);
            padding: 4px;
            margin: -20px 20px 0;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            position: relative;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .tab-btn {
            flex: 1;
            padding: 12px 0;
            text-align: center;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .tab-btn:hover:not(.active) {
            color: var(--primary-blue);
            background: rgba(37, 99, 235, 0.05);
        }

        [data-theme="dark"] .tab-btn:hover:not(.active) {
            background: rgba(37, 99, 235, 0.15);
        }

        .tab-btn.active {
            background: var(--primary-blue);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        /* Content Area */
        .content-section {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .content-section::-webkit-scrollbar { display: none; }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: slideIn 0.4s ease; }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Period Selector */
        .period-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 5px;
            scrollbar-width: none;
        }

        .period-bar::-webkit-scrollbar { display: none; }

        .period-btn {
            padding: 10px 20px;
            border-radius: 20px;
            border: 1.5px solid var(--border);
            background: var(--card-bg);
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .period-btn:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
            transform: translateY(-1px);
        }

        .period-btn.active {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25);
        }

        .period-btn:active { transform: scale(0.95); }

        /* Chart Card */
        .chart-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
        }

        .chart-card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        [data-theme="dark"] .chart-card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .chart-actions {
            display: flex;
            gap: 8px;
        }

        .chart-action-btn {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            border: 1.5px solid var(--border);
            background: var(--card-bg);
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .chart-action-btn:hover {
            background: var(--light-blue);
            border-color: var(--primary-blue);
            color: var(--primary-blue);
            transform: translateY(-2px);
        }

        [data-theme="dark"] .chart-action-btn:hover {
            background: var(--bg-tertiary);
        }

        .chart-action-btn:active { transform: scale(0.9); }

        /* Revenue Chart */
        .revenue-chart {
            position: relative;
            height: 200px;
        }

        .chart-y-axis {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 30px;
            width: 40px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: flex-end;
            padding-right: 8px;
        }

        .y-label {
            font-size: 10px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .chart-area {
            position: absolute;
            left: 45px;
            right: 0;
            top: 0;
            bottom: 30px;
        }

        .chart-bars {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            height: 100%;
            gap: 8px;
        }

        .bar-group {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            height: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .bar-group:hover {
            transform: translateY(-5px);
        }

        .bar-stack {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 2px;
            transition: all 0.3s ease;
        }

        .bar-segment {
            width: 100%;
            border-radius: 4px 4px 0 0;
            min-height: 4px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .bar-segment:hover {
            filter: brightness(1.2);
            transform: scaleX(1.05);
        }

        .bar-segment.food { background: linear-gradient(180deg, #3B82F6, #2563EB); }
        .bar-segment.delivery { background: linear-gradient(180deg, #10B981, #059669); }
        .bar-segment.service { background: linear-gradient(180deg, #8B5CF6, #7C3AED); }

        [data-theme="dark"] .bar-segment.food { background: linear-gradient(180deg, #60A5FA, #3B82F6); }
        [data-theme="dark"] .bar-segment.delivery { background: linear-gradient(180deg, #34D399, #10B981); }
        [data-theme="dark"] .bar-segment.service { background: linear-gradient(180deg, #A78BFA, #8B5CF6); }

        .bar-tooltip {
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%) scale(0);
            background: var(--text-primary);
            color: var(--bg-primary);
            padding: 6px 10px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
            pointer-events: none;
            transition: all 0.2s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 10;
        }

        [data-theme="dark"] .bar-tooltip {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .bar-segment:hover .bar-tooltip {
            transform: translateX(-50%) scale(1);
        }

        .bar-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--text-primary);
        }

        [data-theme="dark"] .bar-tooltip::after {
            border-top-color: var(--bg-tertiary);
        }

        .bar-label {
            margin-top: 8px;
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 500;
            transition: all 0.2s;
        }

        .bar-group:hover .bar-label {
            color: var(--primary-blue);
            font-weight: 600;
        }

        /* Legend */
        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
            flex-wrap: wrap;
            transition: border-color 0.3s;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 20px;
            transition: all 0.3s ease;
            user-select: none;
        }

        .legend-item:hover {
            background: var(--hover-bg);
        }

        .legend-item.disabled {
            opacity: 0.4;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
            transition: all 0.3s;
        }

        .legend-item:hover .legend-color {
            transform: scale(1.2);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 18px;
            box-shadow: var(--card-shadow);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        [data-theme="dark"] .stat-card:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
        }

        .stat-card:active { transform: scale(0.98); }

        .stat-card.selected {
            ring: 2px solid var(--primary-blue);
            background: var(--light-blue);
        }

        [data-theme="dark"] .stat-card.selected {
            background: rgba(37, 99, 235, 0.2);
        }

        .stat-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .stat-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .stat-card:hover .stat-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .stat-icon.blue { background: var(--light-blue); color: var(--primary-blue); }
        .stat-icon.green { background: rgba(16, 185, 129, 0.15); color: var(--success); }
        .stat-icon.purple { background: rgba(139, 92, 246, 0.15); color: var(--purple); }
        .stat-icon.orange { background: rgba(249, 115, 22, 0.15); color: var(--orange); }

        [data-theme="dark"] .stat-icon.blue { background: rgba(37, 99, 235, 0.2); }
        [data-theme="dark"] .stat-icon.green { background: rgba(16, 185, 129, 0.2); }
        [data-theme="dark"] .stat-icon.purple { background: rgba(139, 92, 246, 0.2); }
        [data-theme="dark"] .stat-icon.orange { background: rgba(249, 115, 22, 0.2); }

        .stat-title {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
            transition: color 0.3s;
        }

        .stat-value {
            font-size: 22px;
            font-weight: 700;
            color: var(--text-primary);
            transition: all 0.3s;
        }

        .stat-card:hover .stat-value {
            color: var(--primary-blue);
        }

        .stat-subtitle {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 4px;
            transition: color 0.3s;
        }

        /* Payment Method Cards */
        .payment-methods {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .payment-card {
            flex: 1;
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .payment-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }

        [data-theme="dark"] .payment-card:hover {
            box-shadow: 0 12px 30px rgba(0,0,0,0.4);
        }

        .payment-card:active { transform: scale(0.98); }

        .payment-card.selected {
            border-color: var(--primary-blue);
            background: var(--light-blue);
        }

        [data-theme="dark"] .payment-card.selected {
            background: rgba(37, 99, 235, 0.15);
        }

        .payment-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            transition: width 0.3s ease;
        }

        .payment-card:hover::before {
            width: 6px;
        }

        .payment-card.cod::before { background: var(--warning); }
        .payment-card.gcash::before { background: var(--primary-blue); }

        .payment-card.selected::before {
            width: 100%;
            opacity: 0.1;
        }

        .payment-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .payment-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .payment-card:hover .payment-icon {
            transform: scale(1.1);
        }

        .payment-icon.cod { background: rgba(245, 158, 11, 0.15); color: var(--warning); }
        .payment-icon.gcash { background: var(--light-blue); color: var(--primary-blue); }

        [data-theme="dark"] .payment-icon.cod { background: rgba(245, 158, 11, 0.2); }
        [data-theme="dark"] .payment-icon.gcash { background: rgba(37, 99, 235, 0.2); }

        .payment-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .payment-count {
            font-size: 11px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .payment-amount {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            transition: all 0.3s;
        }

        .payment-card:hover .payment-amount {
            transform: scale(1.05);
        }

        .payment-percentage {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .payment-percentage.cod {
            background: rgba(245, 158, 11, 0.15);
            color: var(--warning);
        }

        .payment-percentage.gcash {
            background: var(--light-blue);
            color: var(--primary-blue);
        }

        [data-theme="dark"] .payment-percentage.cod { background: rgba(245, 158, 11, 0.2); }
        [data-theme="dark"] .payment-percentage.gcash { background: rgba(37, 99, 235, 0.2); }

        /* Comparison Chart */
        .comparison-chart {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--card-shadow);
            transition: all 0.3s;
        }

        .donut-container {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .donut-chart {
            position: relative;
            width: 140px;
            height: 140px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .donut-chart:hover {
            transform: scale(1.05);
        }

        .donut-svg {
            transform: rotate(-90deg);
        }

        .donut-bg {
            fill: none;
            stroke: var(--border);
            stroke-width: 20;
            transition: stroke 0.3s;
        }

        .donut-segment {
            fill: none;
            stroke-width: 20;
            stroke-linecap: round;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .donut-segment:hover {
            stroke-width: 24;
            filter: brightness(1.1);
        }

        .donut-segment.cod { stroke: var(--warning); }
        .donut-segment.gcash { stroke: var(--primary-blue); }

        .donut-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            pointer-events: none;
        }

        .donut-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .donut-label {
            font-size: 11px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .donut-legend {
            flex: 1;
        }

        .donut-legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding: 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .donut-legend-item:hover {
            background: var(--hover-bg);
        }

        .donut-legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .donut-legend-item:hover .donut-legend-color {
            transform: scale(1.2);
        }

        .donut-legend-color.cod { background: var(--warning); }
        .donut-legend-color.gcash { background: var(--primary-blue); }

        .donut-legend-info {
            flex: 1;
        }

        .donut-legend-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .donut-legend-value {
            font-size: 12px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        /* Recent Transactions */
        .transactions-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            transition: all 0.3s;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .view-all-btn {
            font-size: 12px;
            color: var(--primary-blue);
            font-weight: 600;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 20px;
            transition: all 0.3s;
        }

        .view-all-btn:hover {
            background: var(--light-blue);
        }

        [data-theme="dark"] .view-all-btn:hover {
            background: rgba(37, 99, 235, 0.2);
        }

        .transaction-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 0;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 -10px;
            padding-left: 10px;
            padding-right: 10px;
            border-radius: 10px;
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-item:hover {
            background: var(--hover-bg);
            transform: translateX(5px);
        }

        .transaction-item:active {
            transform: scale(0.98);
        }

        .transaction-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .transaction-icon {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s;
        }

        .transaction-item:hover .transaction-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .transaction-icon.cod { background: rgba(245, 158, 11, 0.15); color: var(--warning); }
        .transaction-icon.gcash { background: var(--light-blue); color: var(--primary-blue); }

        [data-theme="dark"] .transaction-icon.cod { background: rgba(245, 158, 11, 0.2); }
        [data-theme="dark"] .transaction-icon.gcash { background: rgba(37, 99, 235, 0.2); }

        .transaction-details h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 3px;
            transition: color 0.3s;
        }

        .transaction-item:hover .transaction-details h4 {
            color: var(--primary-blue);
        }

        .transaction-details p {
            font-size: 12px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .transaction-amount {
            text-align: right;
        }

        .transaction-amount .amount {
            font-size: 15px;
            font-weight: 700;
            color: var(--text-primary);
            transition: all 0.3s;
        }

        .transaction-item:hover .transaction-amount .amount {
            color: var(--primary-blue);
            transform: scale(1.1);
        }

        .transaction-amount .method {
            font-size: 10px;
            padding: 3px 10px;
            border-radius: 12px;
            margin-top: 4px;
            display: inline-block;
            font-weight: 600;
            transition: all 0.3s;
        }

        .transaction-amount .method.cod {
            background: rgba(245, 158, 11, 0.15);
            color: var(--warning);
        }

        .transaction-amount .method.gcash {
            background: var(--light-blue);
            color: var(--primary-blue);
        }

        [data-theme="dark"] .transaction-amount .method.cod { background: rgba(245, 158, 11, 0.2); }
        [data-theme="dark"] .transaction-amount .method.gcash { background: rgba(37, 99, 235, 0.2); }

        /* Export Button */
        .export-section {
            margin-top: 20px;
            margin-bottom: 30px;
        }

        .export-btn {
            width: 100%;
            background: var(--card-bg);
            color: var(--text-primary);
            border: 2px dashed var(--border);
            padding: 18px;
            border-radius: 16px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }

        .export-btn:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
            background: var(--light-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.15);
        }

        [data-theme="dark"] .export-btn:hover {
            background: rgba(37, 99, 235, 0.15);
        }

        .export-btn:active { transform: scale(0.98); }

        .export-btn.loading {
            color: transparent;
        }

        .export-btn.loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid var(--primary-blue);
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Detail Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--overlay-bg);
            backdrop-filter: blur(4px);
            z-index: 1000;
            display: flex;
            align-items: flex-end;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal-sheet {
            background: var(--card-bg);
            width: 100%;
            border-radius: 30px 30px 0 0;
            padding: 30px;
            transform: translateY(100%);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-height: 70%;
            overflow-y: auto;
        }

        .modal-overlay.active .modal-sheet {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            background: var(--hover-bg);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--border);
            color: var(--text-primary);
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
            transition: border-color 0.3s;
        }

        .detail-label {
            font-size: 14px;
            color: var(--text-secondary);
            transition: color 0.3s;
        }

        .detail-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            transition: color 0.3s;
        }

        .detail-value.positive { color: var(--success); }
        .detail-value.negative { color: var(--danger); }

        /* Toast */
        .toast {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: var(--text-primary);
            color: var(--bg-primary);
            padding: 14px 28px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 500;
            z-index: 2000;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        [data-theme="dark"] .toast {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .toast-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .toast-icon.success { background: var(--success); color: white; }
        .toast-icon.error { background: var(--danger); color: white; }

        /* Pull to refresh */
        .refresh-indicator {
            position: absolute;
            top: -50px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: var(--card-bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s;
            color: var(--text-primary);
        }

        .refresh-indicator.visible {
            opacity: 1;
            top: 20px;
        }

        .refresh-indicator.spinning i {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body>

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">
        <i class="fa-solid fa-moon" id="themeIcon"></i>
    </button>

    <div class="app-container">
       
        <!-- Pull to Refresh -->
        <div class="refresh-indicator" id="refreshIndicator">
            <i class="fa-solid fa-rotate-right"></i>
        </div>

        <!-- Header -->
        <div class="reports-header">
            <div class="header-top">
                <div class="greeting">
                    <p>Admin Dashboard</p>
                    <h2>Reports & Monitoring</h2>
                </div>
                <button class="back-btn" onclick="goBack()">
                    <i class="fa-solid fa-arrow-left"></i>
                </button>
            </div>

            <div class="summary-cards">
                <div class="summary-card" onclick="showDetailModal('revenue')">
                    <div class="summary-label">Total Revenue</div>
                    <div class="summary-value" id="totalRevenue">₱45,230</div>
                    <div class="summary-change positive">
                        <i class="fa-solid fa-arrow-trend-up"></i> +12.5%
                    </div>
                </div>
                <div class="summary-card" onclick="showDetailModal('orders')">
                    <div class="summary-label">Total Orders</div>
                    <div class="summary-value" id="totalOrders">1,248</div>
                    <div class="summary-change positive">
                        <i class="fa-solid fa-arrow-trend-up"></i> +8.3%
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('revenue')" data-tab="revenue">
                <i class="fa-solid fa-chart-column"></i> Revenue
            </button>
            <button class="tab-btn" onclick="switchTab('transactions')" data-tab="transactions">
                <i class="fa-solid fa-money-bill-transfer"></i> Transactions
            </button>
        </div>

        <!-- Content Area -->
        <div class="content-section" id="contentSection">
            
            <!-- Revenue Reports Tab -->
            <div class="tab-content active" id="revenue-tab">
                
                <!-- Period Selector -->
                <div class="period-bar">
                    <button class="period-btn active" onclick="changeRevenuePeriod('daily', this)">Daily</button>
                    <button class="period-btn" onclick="changeRevenuePeriod('weekly', this)">Weekly</button>
                    <button class="period-btn" onclick="changeRevenuePeriod('monthly', this)">Monthly</button>
                </div>

                <!-- Revenue Chart -->
                <div class="chart-card">
                    <div class="chart-header">
                        <span class="chart-title">Revenue Breakdown</span>
                        <div class="chart-actions">
                            <button class="chart-action-btn" onclick="downloadChart()" title="Download">
                                <i class="fa-solid fa-download"></i>
                            </button>
                            <button class="chart-action-btn" onclick="toggleChartOptions()" title="More">
                                <i class="fa-solid fa-ellipsis"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="revenue-chart" id="revenueChart">
                        <!-- Chart injected by JS -->
                    </div>

                    <div class="chart-legend" id="chartLegend">
                        <div class="legend-item" onclick="toggleLegend('food')" data-type="food">
                            <div class="legend-color" style="background: var(--primary-blue)"></div>
                            <span>Food Delivery</span>
                        </div>
                        <div class="legend-item" onclick="toggleLegend('package')" data-type="package">
                            <div class="legend-color" style="background: var(--success)"></div>
                            <span>Package</span>
                        </div>
                        <div class="legend-item" onclick="toggleLegend('service')" data-type="service">
                            <div class="legend-color" style="background: var(--purple)"></div>
                            <span>Service Fees</span>
                        </div>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card" onclick="showStatDetail('food')">
                        <div class="stat-header">
                            <div class="stat-icon blue"><i class="fa-solid fa-utensils"></i></div>
                            <span class="stat-title">Food Delivery</span>
                        </div>
                        <div class="stat-value" id="foodRevenue">₱28,450</div>
                        <div class="stat-subtitle">63% of total revenue</div>
                    </div>
                    <div class="stat-card" onclick="showStatDetail('package')">
                        <div class="stat-header">
                            <div class="stat-icon green"><i class="fa-solid fa-box"></i></div>
                            <span class="stat-title">Package</span>
                        </div>
                        <div class="stat-value" id="packageRevenue">₱12,800</div>
                        <div class="stat-subtitle">28% of total revenue</div>
                    </div>
                    <div class="stat-card" onclick="showStatDetail('service')">
                        <div class="stat-header">
                            <div class="stat-icon purple"><i class="fa-solid fa-percent"></i></div>
                            <span class="stat-title">Service Fees</span>
                        </div>
                        <div class="stat-value" id="serviceRevenue">₱3,980</div>
                        <div class="stat-subtitle">9% of total revenue</div>
                    </div>
                    <div class="stat-card" onclick="showStatDetail('avg')">
                        <div class="stat-header">
                            <div class="stat-icon orange"><i class="fa-solid fa-users"></i></div>
                            <span class="stat-title">Avg Order Value</span>
                        </div>
                        <div class="stat-value" id="avgOrder">₱362</div>
                        <div class="stat-subtitle">Per transaction</div>
                    </div>
                </div>

                <!-- Export -->
                <div class="export-section">
                    <button class="export-btn" onclick="exportReport(this)">
                        <i class="fa-solid fa-file-export"></i> Export Revenue Report
                    </button>
                </div>
            </div>

            <!-- Transaction Monitoring Tab -->
            <div class="tab-content" id="transactions-tab">
                
                <!-- Period Selector -->
                <div class="period-bar">
                    <button class="period-btn active" onclick="changeTransactionPeriod('today', this)">Today</button>
                    <button class="period-btn" onclick="changeTransactionPeriod('week', this)">This Week</button>
                    <button class="period-btn" onclick="changeTransactionPeriod('month', this)">This Month</button>
                </div>

                <!-- Payment Method Cards -->
                <div class="payment-methods">
                    <div class="payment-card cod" onclick="selectPaymentMethod('cod')" id="codCard">
                        <div class="payment-header">
                            <div class="payment-icon cod"><i class="fa-solid fa-money-bill-wave"></i></div>
                            <div>
                                <div class="payment-name">Cash on Delivery</div>
                                <div class="payment-count" id="codCount">156 orders</div>
                            </div>
                        </div>
                        <div class="payment-amount" id="codAmount">₱18,450</div>
                        <span class="payment-percentage cod" id="codPercent">42%</span>
                    </div>
                    <div class="payment-card gcash" onclick="selectPaymentMethod('gcash')" id="gcashCard">
                        <div class="payment-header">
                            <div class="payment-icon gcash"><i class="fa-solid fa-mobile-screen"></i></div>
                            <div>
                                <div class="payment-name">GCash</div>
                                <div class="payment-count" id="gcashCount">214 orders</div>
                            </div>
                        </div>
                        <div class="payment-amount" id="gcashAmount">₱25,600</div>
                        <span class="payment-percentage gcash" id="gcashPercent">58%</span>
                    </div>
                </div>

                <!-- Comparison Chart -->
                <div class="comparison-chart">
                    <div class="chart-header">
                        <span class="chart-title">Payment Distribution</span>
                    </div>
                    <div class="donut-container">
                        <div class="donut-chart" onclick="rotateDonut()">
                            <svg class="donut-svg" width="140" height="140" viewBox="0 0 140 140">
                                <circle class="donut-bg" cx="70" cy="70" r="50"></circle>
                                <circle class="donut-segment gcash" cx="70" cy="70" r="50" 
                                    stroke-dasharray="220 314" stroke-dashoffset="0" id="gcashSegment"></circle>
                                <circle class="donut-segment cod" cx="70" cy="70" r="50" 
                                    stroke-dasharray="94 314" stroke-dashoffset="-220" id="codSegment"></circle>
                            </svg>
                            <div class="donut-center">
                                <div class="donut-value" id="donutTotal">370</div>
                                <div class="donut-label">Total</div>
                            </div>
                        </div>
                        <div class="donut-legend">
                            <div class="donut-legend-item" onclick="highlightSegment('gcash')">
                                <div class="donut-legend-color gcash"></div>
                                <div class="donut-legend-info">
                                    <div class="donut-legend-name">GCash</div>
                                    <div class="donut-legend-value">Digital payments</div>
                                </div>
                            </div>
                            <div class="donut-legend-item" onclick="highlightSegment('cod')">
                                <div class="donut-legend-color cod"></div>
                                <div class="donut-legend-info">
                                    <div class="donut-legend-name">Cash on Delivery</div>
                                    <div class="donut-legend-value">Cash handling</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Transactions -->
                <div class="transactions-card">
                    <div class="card-header">
                        <span class="card-title">Recent Transactions</span>
                        <span class="view-all-btn" onclick="viewAllTransactions()">View All</span>
                    </div>
                    
                    <div id="recentTransactions">
                        <!-- Injected by JS -->
                    </div>
                </div>

                <!-- Export -->
                <div class="export-section">
                    <button class="export-btn" onclick="exportTransactions(this)">
                        <i class="fa-solid fa-file-export"></i> Export Transaction Log
                    </button>
                </div>
            </div>

        </div>

        <!-- Detail Modal -->
        <div class="modal-overlay" id="detailModal" onclick="closeModal(event)">
            <div class="modal-sheet" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <h3 class="modal-title" id="modalTitle">Details</h3>
                    <button class="modal-close" onclick="closeModal()">
                        <i class="fa-solid fa-xmark"></i>
                    </button>
                </div>
                <div id="modalContent">
                    <!-- Dynamic content -->
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div class="toast" id="toast">
            <div class="toast-icon success"><i class="fa-solid fa-check"></i></div>
            <span id="toastMsg">Action completed successfully!</span>
        </div>

    </div>

    <script>
        // Theme Management
        let isDarkMode = false;
        
        // Check system preference on load
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            isDarkMode = true;
            applyTheme();
        }

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            isDarkMode = e.matches;
            applyTheme();
        });

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            applyTheme();
            showToast(isDarkMode ? 'Dark mode enabled' : 'Light mode enabled', 'success');
        }

        function applyTheme() {
            const body = document.body;
            const icon = document.getElementById('themeIcon');
            
            if (isDarkMode) {
                body.setAttribute('data-theme', 'dark');
                icon.className = 'fa-solid fa-sun';
            } else {
                body.removeAttribute('data-theme');
                icon.className = 'fa-solid fa-moon';
            }
            
            // Save preference
            localStorage.setItem('darkMode', isDarkMode);
        }

        // Load saved preference
        const savedDarkMode = localStorage.getItem('darkMode');
        if (savedDarkMode !== null) {
            isDarkMode = savedDarkMode === 'true';
            applyTheme();
        }

        // State Management
        let currentRevenuePeriod = 'daily';
        let currentTransactionPeriod = 'today';
        let activeLegends = new Set(['food', 'package', 'service']);
        let selectedPaymentMethod = null;

        // Data
        const revenueData = {
            daily: {
                total: '₱45,230',
                orders: '1,248',
                food: '₱28,450',
                package: '₱12,800',
                service: '₱3,980',
                avg: '₱362',
                chart: [
                    { label: '6AM', food: 30, package: 15, service: 5 },
                    { label: '9AM', food: 45, package: 25, service: 8 },
                    { label: '12PM', food: 80, package: 40, service: 12 },
                    { label: '3PM', food: 65, package: 35, service: 10 },
                    { label: '6PM', food: 90, package: 50, service: 15 },
                    { label: '9PM', food: 60, package: 30, service: 8 },
                    { label: '12AM', food: 40, package: 20, service: 5 }
                ]
            },
            weekly: {
                total: '₱316,610',
                orders: '8,736',
                food: '₱199,150',
                package: '₱89,600',
                service: '₱27,860',
                avg: '₱362',
                chart: [
                    { label: 'Mon', food: 60, package: 30, service: 10 },
                    { label: 'Tue', food: 75, package: 40, service: 12 },
                    { label: 'Wed', food: 50, package: 25, service: 8 },
                    { label: 'Thu', food: 85, package: 45, service: 15 },
                    { label: 'Fri', food: 70, package: 35, service: 10 },
                    { label: 'Sat', food: 95, package: 55, service: 18 },
                    { label: 'Sun', food: 80, package: 40, service: 12 }
                ]
            },
            monthly: {
                total: '₱1,266,440',
                orders: '34,944',
                food: '₱796,600',
                package: '₱358,400',
                service: '₱111,440',
                avg: '₱362',
                chart: [
                    { label: 'W1', food: 70, package: 35, service: 12 },
                    { label: 'W2', food: 85, package: 42, service: 15 },
                    { label: 'W3', food: 60, package: 28, service: 10 },
                    { label: 'W4', food: 90, package: 48, service: 18 }
                ]
            }
        };

        const transactionData = {
            today: {
                cod: { amount: '₱18,450', count: 156, percent: 42 },
                gcash: { amount: '₱25,600', count: 214, percent: 58 },
                total: 370
            },
            week: {
                cod: { amount: '₱129,150', count: 1092, percent: 40 },
                gcash: { amount: '₱193,800', count: 1638, percent: 60 },
                total: 2730
            },
            month: {
                cod: { amount: '₱516,600', count: 4368, percent: 38 },
                gcash: { amount: '₱843,600', count: 7132, percent: 62 },
                total: 11500
            }
        };

        let recentTransactions = [
            { id: 'TRX-001', type: 'gcash', title: 'Order #7782', time: '2 mins ago', amount: '₱450.00', method: 'GCash', status: 'completed' },
            { id: 'TRX-002', type: 'cod', title: 'Order #7781', time: '5 mins ago', amount: '₱320.00', method: 'COD', status: 'completed' },
            { id: 'TRX-003', type: 'gcash', title: 'Order #7780', time: '12 mins ago', amount: '₱890.00', method: 'GCash', status: 'completed' },
            { id: 'TRX-004', type: 'cod', title: 'Order #7779', time: '18 mins ago', amount: '₱150.00', method: 'COD', status: 'pending' },
            { id: 'TRX-005', type: 'gcash', title: 'Order #7778', time: '25 mins ago', amount: '₱675.00', method: 'GCash', status: 'completed' }
        ];

        // Initialize
        function init() {
            renderRevenueChart(currentRevenuePeriod);
            renderTransactions();
            setupPullToRefresh();
        }

        // Tab Switching with animation
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.tab === tabName) btn.classList.add('active');
            });

            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            const targetTab = document.getElementById(tabName + '-tab');
            if (targetTab) {
                targetTab.classList.add('active');
            }
        }

        // Revenue Period Change
        function changeRevenuePeriod(period, btn) {
            currentRevenuePeriod = period;
            
            document.querySelectorAll('#revenue-tab .period-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            const data = revenueData[period];
            animateValue('totalRevenue', data.total);
            animateValue('totalOrders', data.orders);
            document.getElementById('foodRevenue').textContent = data.food;
            document.getElementById('packageRevenue').textContent = data.package;
            document.getElementById('serviceRevenue').textContent = data.service;
            document.getElementById('avgOrder').textContent = data.avg;

            renderRevenueChart(period);
            showToast(`Switched to ${period} view`, 'success');
        }

        // Render Revenue Chart with interactive bars
        function renderRevenueChart(period) {
            const data = revenueData[period].chart;
            const container = document.getElementById('revenueChart');
            
            let maxVal = 0;
            data.forEach(d => {
                let sum = 0;
                if (activeLegends.has('food')) sum += d.food;
                if (activeLegends.has('package')) sum += d.package;
                if (activeLegends.has('service')) sum += d.service;
                if (sum > maxVal) maxVal = sum;
            });

            const yLabels = [maxVal, Math.floor(maxVal * 0.75), Math.floor(maxVal * 0.5), Math.floor(maxVal * 0.25), 0];

            let html = `
                <div class="chart-y-axis">
                    ${yLabels.map(v => `<span class="y-label">₱${v}</span>`).join('')}
                </div>
                <div class="chart-area">
                    <div class="chart-bars">
            `;

            data.forEach((d, idx) => {
                html += `<div class="bar-group" onclick="showBarDetail('${d.label}', ${idx})"><div class="bar-stack">`;
                
                if (activeLegends.has('food')) {
                    const h = maxVal > 0 ? (d.food / maxVal) * 100 : 0;
                    html += `<div class="bar-segment food" style="height: ${Math.max(h, 4)}%" onclick="event.stopPropagation(); showSegmentDetail('food', '${d.label}', ${d.food})"><span class="bar-tooltip">₱${d.food}</span></div>`;
                }
                if (activeLegends.has('package')) {
                    const h = maxVal > 0 ? (d.package / maxVal) * 100 : 0;
                    html += `<div class="bar-segment delivery" style="height: ${Math.max(h, 4)}%" onclick="event.stopPropagation(); showSegmentDetail('package', '${d.label}', ${d.package})"><span class="bar-tooltip">₱${d.package}</span></div>`;
                }
                if (activeLegends.has('service')) {
                    const h = maxVal > 0 ? (d.service / maxVal) * 100 : 0;
                    html += `<div class="bar-segment service" style="height: ${Math.max(h, 4)}%" onclick="event.stopPropagation(); showSegmentDetail('service', '${d.label}', ${d.service})"><span class="bar-tooltip">₱${d.service}</span></div>`;
                }
                
                html += `</div><span class="bar-label">${d.label}</span></div>`;
            });

            html += '</div></div>';
            container.innerHTML = html;
        }

        // Toggle Legend
        function toggleLegend(type) {
            const item = document.querySelector(`.legend-item[data-type="${type}"]`);
            
            if (activeLegends.has(type)) {
                if (activeLegends.size > 1) {
                    activeLegends.delete(type);
                    item.classList.add('disabled');
                }
            } else {
                activeLegends.add(type);
                item.classList.remove('disabled');
            }
            
            renderRevenueChart(currentRevenuePeriod);
        }

        // Transaction Period Change
        function changeTransactionPeriod(period, btn) {
            currentTransactionPeriod = period;
            
            document.querySelectorAll('#transactions-tab .period-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            const data = transactionData[period];
            document.getElementById('codAmount').textContent = data.cod.amount;
            document.getElementById('codCount').textContent = data.cod.count.toLocaleString() + ' orders';
            document.getElementById('codPercent').textContent = data.cod.percent + '%';
            document.getElementById('gcashAmount').textContent = data.gcash.amount;
            document.getElementById('gcashCount').textContent = data.gcash.count.toLocaleString() + ' orders';
            document.getElementById('gcashPercent').textContent = data.gcash.percent + '%';
            
            animateValue('donutTotal', data.total.toLocaleString());
            updateDonutChart(data.cod.percent, data.gcash.percent);
            
            showToast(`Showing ${period} transactions`, 'success');
        }

        // Update Donut Chart
        function updateDonutChart(codPercent, gcashPercent) {
            const circumference = 314;
            const gcashValue = (gcashPercent / 100) * circumference;
            const codValue = (codPercent / 100) * circumference;
            
            document.getElementById('gcashSegment').style.strokeDasharray = `${gcashValue} ${circumference}`;
            document.getElementById('codSegment').style.strokeDasharray = `${codValue} ${circumference}`;
            document.getElementById('codSegment').style.strokeDashoffset = -gcashValue;
        }

        // Select Payment Method
        function selectPaymentMethod(method) {
            document.querySelectorAll('.payment-card').forEach(c => c.classList.remove('selected'));
            document.getElementById(method + 'Card').classList.add('selected');
            selectedPaymentMethod = method;
            
            // Filter transactions
            renderTransactions(method);
            showToast(`${method.toUpperCase()} transactions filtered`, 'success');
        }

        // Render Transactions
        function renderTransactions(filter = 'all') {
            const container = document.getElementById('recentTransactions');
            const filtered = filter === 'all' ? recentTransactions : recentTransactions.filter(t => t.type === filter);
            
            container.innerHTML = filtered.map(t => `
                <div class="transaction-item" onclick="showTransactionDetail('${t.id}')">
                    <div class="transaction-info">
                        <div class="transaction-icon ${t.type}">
                            <i class="fa-solid ${t.type === 'cod' ? 'fa-money-bill-wave' : 'fa-mobile-screen'}"></i>
                        </div>
                        <div class="transaction-details">
                            <h4>${t.title}</h4>
                            <p>${t.time} • ${t.status}</p>
                        </div>
                    </div>
                    <div class="transaction-amount">
                        <div class="amount">${t.amount}</div>
                        <span class="method ${t.type}">${t.method}</span>
                    </div>
                </div>
            `).join('');
        }

        // Highlight Donut Segment
        function highlightSegment(type) {
            const segment = document.getElementById(type + 'Segment');
            segment.style.strokeWidth = '28';
            setTimeout(() => {
                segment.style.strokeWidth = '20';
            }, 300);
        }

        // Rotate Donut Animation
        let donutRotation = 0;
        function rotateDonut() {
            donutRotation += 90;
            document.querySelector('.donut-svg').style.transform = `rotate(${-90 + donutRotation}deg)`;
        }

        // Show Detail Modal
        function showDetailModal(type) {
            const modal = document.getElementById('detailModal');
            const title = document.getElementById('modalTitle');
            const content = document.getElementById('modalContent');
            
            modal.classList.add('active');
            
            if (type === 'revenue') {
                title.textContent = 'Revenue Breakdown';
                content.innerHTML = `
                    <div class="detail-row"><span class="detail-label">Gross Revenue</span><span class="detail-value">₱45,230</span></div>
                    <div class="detail-row"><span class="detail-label">Deductions</span><span class="detail-value negative">-₱2,450</span></div>
                    <div class="detail-row"><span class="detail-label">Net Revenue</span><span class="detail-value positive">₱42,780</span></div>
                    <div class="detail-row"><span class="detail-label">Pending Clearance</span><span class="detail-value">₱5,200</span></div>
                `;
            } else {
                title.textContent = 'Order Statistics';
                content.innerHTML = `
                    <div class="detail-row"><span class="detail-label">Completed</span><span class="detail-value positive">1,180</span></div>
                    <div class="detail-row"><span class="detail-label">In Progress</span><span class="detail-value">45</span></div>
                    <div class="detail-row"><span class="detail-label">Cancelled</span><span class="detail-value negative">23</span></div>
                    <div class="detail-row"><span class="detail-label">Refund Rate</span><span class="detail-value">1.8%</span></div>
                `;
            }
        }

        // Show Stat Detail
        function showStatDetail(type) {
            const details = {
                food: { title: 'Food Delivery Details', content: 'Popular cuisines: Filipino, Fast Food, Japanese' },
                package: { title: 'Package Details', content: 'Average weight: 2.3kg, Express: 45%' },
                service: { title: 'Service Fees', content: 'Platform fee: 15%, Delivery fee: 10%' },
                avg: { title: 'Order Value Analysis', content: 'Median: ₱340, Highest: ₱2,400' }
            };
            showToast(details[type].title + ' - ' + details[type].content, 'success');
        }

        // Show Bar Detail
        function showBarDetail(label, idx) {
            const data = revenueData[currentRevenuePeriod].chart[idx];
            showToast(`${label}: Total ₱${data.food + data.package + data.service}`, 'success');
        }

        // Show Segment Detail
        function showSegmentDetail(type, label, value) {
            const names = { food: 'Food', package: 'Package', service: 'Service' };
            showToast(`${names[type]} at ${label}: ₱${value}`, 'success');
        }

        // Show Transaction Detail
        function showTransactionDetail(id) {
            const t = recentTransactions.find(x => x.id === id);
            showToast(`Transaction ${id}: ${t.amount} via ${t.method}`, 'success');
        }

        // View All Transactions
        function viewAllTransactions() {
            showToast('Opening full transaction history...', 'success');
        }

        // Export Functions
        function exportReport(btn) {
            btn.classList.add('loading');
            setTimeout(() => {
                btn.classList.remove('loading');
                showToast('Revenue report downloaded!', 'success');
            }, 1500);
        }

        function exportTransactions(btn) {
            btn.classList.add('loading');
            setTimeout(() => {
                btn.classList.remove('loading');
                showToast('Transaction log exported!', 'success');
            }, 1500);
        }

        function downloadChart() {
            showToast('Chart image saved!', 'success');
        }

        function toggleChartOptions() {
            showToast('Chart options: Filter by rider, Compare periods', 'success');
        }

        // Close Modal
        function closeModal(event) {
            if (!event || event.target.id === 'detailModal') {
                document.getElementById('detailModal').classList.remove('active');
            }
        }

        // Go Back
        function goBack() {
            showToast('Navigating back...', 'success');
        }

        // Toast Notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const msg = document.getElementById('toastMsg');
            const icon = toast.querySelector('.toast-icon');
            
            msg.innerText = message;
            icon.className = 'toast-icon ' + type;
            icon.innerHTML = type === 'success' ? '<i class="fa-solid fa-check"></i>' : '<i class="fa-solid fa-info"></i>';
            
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Animate Value Change
        function animateValue(id, newValue) {
            const el = document.getElementById(id);
            el.style.opacity = '0';
            el.style.transform = 'translateY(-10px)';
            setTimeout(() => {
                el.textContent = newValue;
                el.style.opacity = '1';
                el.style.transform = 'translateY(0)';
            }, 200);
        }

        // Pull to Refresh
        function setupPullToRefresh() {
            let startY = 0;
            const content = document.getElementById('contentSection');
            const indicator = document.getElementById('refreshIndicator');
            
            content.addEventListener('touchstart', (e) => {
                if (content.scrollTop === 0) {
                    startY = e.touches[0].clientY;
                }
            });
            
            content.addEventListener('touchmove', (e) => {
                if (content.scrollTop === 0) {
                    const diff = e.touches[0].clientY - startY;
                    if (diff > 50) {
                        indicator.classList.add('visible');
                    }
                }
            });
            
            content.addEventListener('touchend', (e) => {
                if (indicator.classList.contains('visible')) {
                    indicator.classList.add('spinning');
                    setTimeout(() => {
                        indicator.classList.remove('visible', 'spinning');
                        showToast('Data refreshed!', 'success');
                        init();
                    }, 1000);
                }
            });
        }

        // Initialize
        init();
    </script>
</body>
</html>